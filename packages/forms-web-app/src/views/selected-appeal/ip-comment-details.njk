{% extends layoutTemplate %}

{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/tag/macro.njk" import govukTag %}
{% from "pins/components/appeal-sections-block.njk" import appealSectionsBlock %}

{% set title="Interested party comments " + appeal.appealNumber + " - " + titleSuffix + " - GOV.UK" %}

{% block pageTitle %}
	{{ title }}
{% endblock %}

{% block content %}
	<div class="govuk-grid-row">
		<div class="govuk-grid-column-full">
            {% if errorSummary %}
                {{ govukErrorSummary({
                    titleText: "There is a problem",
                    errorList: errorSummary
                }) }}
			{% endif %}

            <span class="govuk-caption-xl">Appeal {{appeal.appealNumber}}</span>
			<h1 class="govuk-heading-xl">Interested party comments</h1>

			{{ govukSummaryList({
				classes: "appeal-headlines govuk-summary-list--no-border",
				rows: appeal.headlineData
			}) }}

			<hr class="govuk-section-break govuk-section-break--visible govuk-section-break--m">

			{% for comment in appeal.formattedComments %}
                <h2 class="govuk-heading-l">{{ comment.key.text }}</h2>
                    <dl class="govuk-summary-list">
                        <div class="govuk-summary-list__row">
                            <dt class="govuk-summary-list__key">Comments</dt>
                            <dd class="govuk-summary-list__value">
                                {% if comment.value.truncated === false %}
                                    <span>{{ comment.value.text }}</span>
                                {% endif %}
                                {% if comment.value.truncated %}
                                    <span id="comment-text-{{ loop.index }}" class="visible" data-truncated-text="{{ comment.value.truncatedText }}" data-full-text="{{ comment.value.text }}"> {{ comment.value.truncatedText }} </span>
                                    <a id="read-more-button-{{ loop.index }}" class="read-more govuk-link visible expand-collapse-button" data-index="{{ loop.index }}">Read more</a>
                                    <a id="close-button-{{ loop.index }}" class="close-button govuk-link hidden expand-collapse-button" data-index="{{ loop.index }}">Close</a>
                                {% endif %}
                            </dd>
                        </div>
                    </dl>
            {% endfor %}
        </div>
    </div>
    <script src="/../../../public/javascripts/commentActions.bundle.js"></script>
{% endblock %}