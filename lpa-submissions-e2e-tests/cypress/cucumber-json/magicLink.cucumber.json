[
  {
    "description": "  As a LPA Planning Officer\n  I want to access the LPA questionnaire\n  So that I can complete with the information needed by the Planning Inspector",
    "keyword": "Feature",
    "name": "LPA Questionnaire Access - Authentication: Magic Link",
    "line": 1,
    "id": "lpa-questionnaire-access---authentication:-magic-link",
    "tags": [],
    "uri": "magicLink.feature",
    "elements": [
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-selects-the-link-in-the-start-email-and-lpa-is-asked-to-provide-email-address",
        "keyword": "Scenario",
        "line": 10,
        "name": "LPA selects the link in the start email and LPA is asked to provide email address",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 579000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 27000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 11,
            "name": "LPA Planning Officer wants to access a questionnaire",
            "result": {
              "status": "passed",
              "duration": 2000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 12,
            "name": "they click on the start questionnaire link in the initial email",
            "result": {
              "status": "passed",
              "duration": 580000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 13,
            "name": "enter email address page will be opened in the browser",
            "result": {
              "status": "passed",
              "duration": 12000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-enters-email-address-not-matched-with-the-lpa-domain",
        "keyword": "Scenario",
        "line": 15,
        "name": "LPA enters email address not matched with the LPA domain",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 524000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 26000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 16,
            "name": "access to the questionnaire is requested",
            "result": {
              "status": "passed",
              "duration": 366000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 17,
            "name": "the email address does not match the domain of the LPA from the appeal",
            "result": {
              "status": "passed",
              "duration": 689000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 18,
            "name": "progress is made to the confirm your email address page",
            "result": {
              "status": "passed",
              "duration": 6000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 19,
            "name": "a magic link is not sent to the user",
            "result": {
              "status": "passed",
              "duration": 45000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-does-not-enter-an-email-address",
        "keyword": "Scenario",
        "line": 21,
        "name": "LPA does not enter an email address",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 498000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 25000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 22,
            "name": "access to the questionnaire is requested",
            "result": {
              "status": "passed",
              "duration": 372000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 23,
            "name": "an email address is not provided",
            "result": {
              "status": "passed",
              "duration": 378000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 24,
            "name": "progress is halted with an error message to 'Enter an email address in the correct format, like name@example.com'",
            "result": {
              "status": "passed",
              "duration": 412000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-enters-email-address-in-invalid-format",
        "keyword": "Scenario",
        "line": 26,
        "name": "LPA enters email address in invalid format",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 475000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 20000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 27,
            "name": "access to the questionnaire is requested",
            "result": {
              "status": "passed",
              "duration": 397000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 28,
            "name": "the email address provided in not in the correct format",
            "result": {
              "status": "passed",
              "duration": 737000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 29,
            "name": "progress is halted with an error message to 'Enter an email address in the correct format, like name@example.com'",
            "result": {
              "status": "passed",
              "duration": 322000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 30,
            "name": "a magic link is not sent to the user",
            "result": {
              "status": "passed",
              "duration": 29000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-enters-email-address-matching-lpa-domain",
        "keyword": "Scenario",
        "line": 32,
        "name": "LPA enters email address matching LPA domain",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 339000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 30000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 33,
            "name": "access to the questionnaire is requested",
            "result": {
              "status": "passed",
              "duration": 698000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 34,
            "name": "a valid email address is provided matching the domain of the LPA",
            "result": {
              "status": "passed",
              "duration": 1685000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 35,
            "name": "progress is made to the confirm your email address page",
            "result": {
              "status": "passed",
              "duration": 11000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 36,
            "name": "a magic link is sent to that email address via Notify",
            "result": {
              "status": "passed",
              "duration": 47000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-selects-to-email-the-customer-support-team",
        "keyword": "Scenario",
        "line": 38,
        "name": "LPA selects to Email the customer support team",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 484000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 20000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 39,
            "name": "the LPA is on the confirm your email page",
            "result": {
              "status": "passed",
              "duration": 261000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 40,
            "name": "they select to email the customer support team",
            "result": {
              "status": "passed",
              "duration": 1000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 41,
            "name": "a mailto link will be provided",
            "result": {
              "status": "passed",
              "duration": 13000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-does-not-receive-magic-link-and-clicks-resend",
        "keyword": "Scenario",
        "line": 43,
        "name": "LPA does not receive magic link and clicks resend",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 449000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 17000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 44,
            "name": "the LPA is on the confirm your email page",
            "result": {
              "status": "passed",
              "duration": 199000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 45,
            "name": "they select ‘resend the email’",
            "result": {
              "status": "passed",
              "duration": 302000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 46,
            "name": "enter email address page will be displayed",
            "result": {
              "status": "passed",
              "duration": 9000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-selects-valid-magic-link-and-accesses-the-questionnaire",
        "keyword": "Scenario",
        "line": 48,
        "name": "LPA selects valid magic link and accesses the questionnaire",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 424000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 17000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 49,
            "name": "LPA user receives a magic link for accessing the questionnaire",
            "result": {
              "status": "passed",
              "duration": 1649000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 50,
            "name": "they select a valid link",
            "result": {
              "status": "passed",
              "duration": 35000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 51,
            "name": "they are redirected to the questionnaire page",
            "result": {
              "status": "passed",
              "duration": 60000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-selects-the-expired-magic-link",
        "keyword": "Scenario",
        "line": 53,
        "name": "LPA selects the expired magic link",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 341000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 29000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 54,
            "name": "LPA user receives a magic link for accessing the questionnaire",
            "result": {
              "status": "passed",
              "duration": 1670000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 55,
            "name": "they select the expired magic link",
            "result": {
              "status": "passed",
              "duration": 315000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 56,
            "name": "enter email address page will be displayed",
            "result": {
              "status": "passed",
              "duration": 6000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 57,
            "name": "a link expired notification banner is displayed on the page",
            "result": {
              "status": "passed",
              "duration": 37000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;authentication-expired---4-hours-expiry",
        "keyword": "Scenario",
        "line": 59,
        "name": "Authentication expired - 4 hours expiry",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 492000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 21000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 60,
            "name": "the session has timed out",
            "result": {
              "status": "passed",
              "duration": 13000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 61,
            "name": "the LPA tries to access the questionnaire",
            "result": {
              "status": "passed",
              "duration": 416000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 62,
            "name": "enter email address page will be displayed",
            "result": {
              "status": "passed",
              "duration": 6000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 63,
            "name": "a session expired notification banner is displayed on the page",
            "result": {
              "status": "passed",
              "duration": 38000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-wants-to-complete-a-questionnaire-and-have-not-authenticated",
        "keyword": "Scenario",
        "line": 65,
        "name": "LPA wants to complete a questionnaire and have not authenticated",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 508000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 30000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 66,
            "name": "the LPA Planning Officer has not been authenticated",
            "result": {
              "status": "passed",
              "duration": 7000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 67,
            "name": "the LPA tries to access the questionnaire",
            "result": {
              "status": "passed",
              "duration": 392000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 68,
            "name": "enter email address page will be displayed",
            "result": {
              "status": "passed",
              "duration": 5000000
            }
          }
        ]
      },
      {
        "id": "lpa-questionnaire-access---authentication:-magic-link;lpa-wants-to-view-the-questionnaire-and-have-been-authenticated",
        "keyword": "Scenario",
        "line": 70,
        "name": "LPA wants to view the questionnaire and have been authenticated",
        "tags": [],
        "type": "scenario",
        "steps": [
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 7,
            "name": "an appeal has been created",
            "result": {
              "status": "passed",
              "duration": 444000000
            }
          },
          {
            "arguments": [],
            "keyword": "And ",
            "line": 8,
            "name": "a questionnaire has been created",
            "result": {
              "status": "passed",
              "duration": 18000000
            }
          },
          {
            "arguments": [],
            "keyword": "Given ",
            "line": 71,
            "name": "the LPA Planning Officer is authenticated",
            "result": {
              "status": "passed",
              "duration": 8000000
            }
          },
          {
            "arguments": [],
            "keyword": "When ",
            "line": 72,
            "name": "the LPA tries to access the questionnaire",
            "result": {
              "status": "passed",
              "duration": 396000000
            }
          },
          {
            "arguments": [],
            "keyword": "Then ",
            "line": 73,
            "name": "the questionnaire page is presented",
            "result": {
              "status": "passed",
              "duration": 5000000
            }
          }
        ]
      }
    ]
  }
]